#
# Copyright (c) 2017 ISPRAS (http://www.ispras.ru)
# Institute for System Programming of the Russian Academy of Sciences
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

import os
import subprocess

os.environ['DEBIAN_FRONTEND'] = 'noninteractive'


def execute_cmd(*args):
    print('Execute command "{0}"'.format(' '.join(args)))
    subprocess.check_call(args)


print('Install RPM packages')
execute_cmd(
    'zypper', 'install', '-y',
    # For Python.
    'make', 'gcc', 'gdbm-devel', 'libbz2-devel', 'libopenssl-devel', 'readline-devel', 'sqlite3-devel', 'tk-devel',
    'xz-devel', 'zlib-devel',
    # For Klever Bridge.
    'nginx', 'postgresql',
    # For Klever Core.
    'graphviz',
    # For building the Linux kernel.
    'glibc-devel-32bit',
    # For CPAchecker 1.6+.
    'java-1_8_0-openjdk-headless'
)

execute_cmd(
    'pip3', 'install', '-U',
    # For Klever Bridge.
    'Django', 'gunicorn', 'psycopg2', 'pytz',
    # For Klever Core.
    'jinja2', 'graphviz', 'ply', 'requests', 'setuptools_scm',
    # For Klever Scheduler.
    'consulate'
)
