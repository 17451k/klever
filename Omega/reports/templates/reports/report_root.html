{% extends 'reports/base.html' %}

{% load i18n %}

{% load tz %}

{% block body_block %}
<div class="row">
    <div class="col-sm-5">
        <span class="Title">{% trans 'General information' %}</span>
        <table class="RootReportTable" border="1">
            <tr class="TableRawEven">
                <td><span class="TableTitle">{% trans 'Report identifier' %}</span></td>
                <td>{{ report.identifier }}</td>
            </tr>

            {% if report.user %}
            <tr class="TableRawOdd">
                <td><span class="TableTitle">{% trans 'Author' %}</span></td>
                <td>
                    <a href="{% url 'users:show_profile' report.user.id %}">{{ report.user.username }}</a>
                </td>
            </tr>
            <tr class="TableRawEven">
                <td><span class="TableTitle">{% trans 'Verification Job' %}</span></td>
                <td>
                    <a href="{% url 'jobs:job' report.job.id %}">{{ report.job.identifier }}</a>
                </td>
            </tr>
            <tr class="TableRawOdd">
                <td><span class="TableTitle">{% trans 'Status' %}</span></td>
                <td>
                    {{ report.job.jobstatus.get_status_display }}
                </td>
            </tr>
            {% endif %}
            {% timezone user_tz %}
            {% if report.user %}
            <tr class="TableRawEven">
                <td><span class="TableTitle">{% trans 'Last request date' %}</span></td>
                <td>
                    {{ report.last_request_date }}
                </td>
            </tr>
            {% endif %}
            <tr class="TableRawOdd">
                <td><span class="TableTitle">{% trans 'Start date' %}</span></td>
                <td>
                    {{ report.start_date }}
                </td>
            </tr>
            <tr class="TableRawEven">
                <td><span class="TableTitle">{% trans 'Finish date' %}</span></td>
                <td>
                    {{ report.finish_date }}
                </td>
            </tr>
            {% endtimezone %}
            <tr class="TableRawOdd">
                <td><span class="TableTitle">{% trans 'Duration' %}</span></td>
                <td>
                    {{ delta }}
                </td>
            </tr>
            <tr class="TableRawEven">
                <td><span class="TableTitle">{% trans 'Computer' %}</span></td>
                <td>
                    {{ report.computer.description }}
                </td>
            </tr>
        </table>

        </br><span class="Title">{% trans 'Attributes' %}</span>
        <table class="RootReportTable" border="1">
            <tr class="TableRawEven">
                <td><span class="TableTitle">{% trans 'Name' %}</span></td>
                <td><span class="TableTitle">{% trans 'Value' %}</span></td>
            </tr>
            {% for attr in report.attr.all %}
            {% if attr.id|divisibleby:"2" %}
            <tr class="TableRawEven">
            {% else %}
            <tr class="TableRawOdd">
            {% endif %}
                <td>{{attr.name.name}}</td>
                <td>{{attr.value}}</td>
            </tr>
            {% endfor %}
        </table>

        </br><span class="Title">{% trans 'Resources' %}</span>
        <table class="RootReportTable" border="1">
            <tr class="TableRawEven">
                <td><span class="TableTitle">{% trans 'Component' %}</span></td>
                <td><span class="TableTitle">{% trans 'CPU time' %}</span></td>
                <td><span class="TableTitle">{% trans 'Wall time' %}</span></td>
                <td><span class="TableTitle">{% trans 'Memory' %}</span></td>
            </tr>
            {% for resource in resources %}
            {% if resource.id|divisibleby:"2" %}
            <tr class="TableRawEven">
            {% else %}
            <tr class="TableRawOdd">
            {% endif %}
                {% if resource.component.name %}
                    <td>{{ resource.component.name }}</td>
                {% else %}
                    <td>Total</td>
                {% endif %}
                <td>{{resource.resource.cpu_time}}</td>
                <td>{{resource.resource.wall_time}}</td>
                <td>{{resource.resource.memory}}</td>
            </tr>
            {% endfor %}
        </table>

        {% if parents %}
        </br><span class="Title">{% trans 'Parents' %}</span>
            <ul>
            {% for parent in parents %}
                {% if not parent.parent %}
                    <li><a href="{% url 'reports:report_root' parent.id %}">{{ parent.identifier }}</a></li>
                {% else %}
                    <li><a href="{% url 'reports:report_component' parent.id %}">{{ parent.identifier }}</a></li>
                {% endif %}
            {% endfor %}
            </ul>
        {% endif %}

        {% if children %}
        <span class="Title">{% trans 'Children' %}</span>
        <ul>
            {% for child in children %}
                <li><a href="{% url 'reports:report_component' child.id %}">{{ child.identifier }}</a></li>
            {% endfor %}
        </ul>
        {% endif %}

        <span class="Title">{% trans 'Log' %}</span>
        </br>{{report.log}}
    </div>
    <div class="col-sm-5">
        <span class="Title">{% trans 'Results' %}</span>
        {% if report.job.verdict %}
                <div class="row">
                    <div class="col-sm-6">
                        <span class="Title"><b>{% trans 'Unsafes' %}: </b></span>
                        <ul>
                            {% for v in verdict.unsafes %}
                                <li><span style="color:{{ v.color }};">{{ v.title }}: </span><a href="#">{{ v.value }}</a></li>
                            {% endfor %}
                        </ul>
                    </div>
                    <div class="col-sm-6">
                        <span class="Title"><b>{% trans 'Safes' %}: </b></span>
                        <ul>
                            {% for v in verdict.safes %}
                                <li><span style="color:{{ v.color }};">{{ v.title }}: </span><a href="#">{{ v.value }}</a></li>
                            {% endfor %}
                        </ul>
                    </div>
                </div>

            {% endif %}

            {% if unknowns %}
                <span class="Title"><b>{% trans 'Problems' %}</b></span>
                {% if verdict %}(<a href="#">{{ verdict.unknowns }}</a>){% endif %}
                <ul>
                    {% for comp in unknowns %}
                        <li>{{ comp.component }}</li>
                        <ul>
                        {% for probl in comp.problems %}
                            <li>{{ probl.problem }}: <a href="#">{{ probl.num }}</a></li>
                        {% endfor %}
                        </ul>
                    {% endfor %}

                </ul>
            {% endif %}
        </br><span class="Title">{% trans 'Description' %}</span></br>
        {{ report.description }}
    </div>
</div>

{% endblock %}