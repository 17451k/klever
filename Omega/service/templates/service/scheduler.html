{% extends 'service/base.html' %}
{% load i18n %}

{% block title %}{% trans 'Scheduler' %}{% endblock %}

{% block body_block %}
    <table class="ui compact olive table">
        <thead>
            <tr>
                <th class="five wide column center aligned">
                    <h3 class="header">{{ data.scheduler.name }}</h3>
                </th>
                <th class="five wide column center aligned">
                    {% if data.scheduler.status == 'HEALTHY' %}
                        <h3 class="ui green header">{% trans 'Available' %}</h3>
                    {% elif data.scheduler.status == 'AILING' %}
                        <h3 class="ui red header">{% trans 'Ailing' %}</h3>
                    {% elif data.scheduler.status == 'DISCONNECTED' %}
                        <h3 class="ui red header">{% trans 'Disconnected' %}</h3>
                    {% endif %}
                </th>
                <th class="six wide column center aligned">
                    {% if data.scheduler.need_auth %}
                        <h3 class="ui red header">{% trans 'Restricted access' %}</h3>
                    {% else %}
                        <h3 class="ui green header">{% trans 'Open access' %}</h3>
                    {% endif %}
                </th>
            </tr>
        </thead>
    </table>
    <div class="ui grid">
        <div class="eight wide column">
            <table class="ui celled compact violet table selectable">
                <thead>
                    <tr>
                        <th class="ten wide column center aligned" colspan="2">{% trans 'Resources' %}</th>
                        <th class="six wide column center aligned">{% trans 'Occupied' %}/{% trans 'Total' %}</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <th class="right aligned" colspan="2">{% trans 'Total RAM' %}</th>
                        <td class="right aligned">{{ data.scheduler_data.ram }}</td>
                    </tr>
                    <tr>
                        <th class="right aligned" colspan="2">{% trans 'Total disc space' %}</th>
                        <td class="right aligned">{{ data.scheduler_data.memory }}</td>
                    </tr>
                    <tr>
                        <th class="right aligned" rowspan="{{ data.scheduler_data.rowspan }}">{% trans 'CPU cores' %}</th>
                        <th class="right aligned">{% trans 'Total' %}</th>
                        <td class="right aligned">{{ data.scheduler_data.cores_total }}</td>
                    </tr>
                    {% for core in data.scheduler_data.cores %}
                        <tr>
                            <th class="right aligned">{{ core.name }}</th>
                            <td class="right aligned">{{ core.value }}</td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        <div class="eight wide column">
            {% if data.tools|length > 0 %}
            <table class="ui celled compact violet table selectable">
                <thead>
                    <tr>
                        <th>{% trans 'Tool' %}</th>
                        <th>{% trans 'Version' %}</th>
                        <th>{% trans 'Used currently' %}</th>
                    </tr>
                </thead>
                <tbody>
                    {% for tool in data.tools %}
                        <tr>
                            <td>{{ tool.name }}</td>
                            <td>{{ tool.version }}</td>
                            <td>{{ tool.usage }}</td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
            {% else %}
                <h3 class="ui violet header">{% trans "There are no supported verification tools by this scheduler" %}</h3>
            {% endif %}
        </div>
    </div>
    {% if data.nodes|length > 0 %}
    <table class="ui celled compact orange table selectable">
        <thead>
            <tr>
                <th>{% trans 'Node' %}</th>
                <th>{% trans 'Availability' %}</th>
                <th>{% trans 'CPU model' %}</th>
                <th>{% trans 'CPU cores' %}</th>
                <th>{% trans 'RAM' %}</th>
                <th>{% trans 'Disk space' %}</th>
                <th>{% trans 'Solving tasks' %}</th>
                <th>{% trans 'Solving jobs' %}</th>
                <th>{% trans 'Reserved for tasks' %}</th>
                <th>{% trans 'Reserved for jobs' %}</th>
            </tr>
        </thead>
        <tbody>
            {% for node in data.nodes %}
                {% if node.workload %}
                    <tr>
                        <td>{{ node.hostname }}</td>
                        <td>{{ node.get_status_display }}</td>
                        <td>{{ node.workload.config.cpu }}</td>
                        <td>{{ node.workload.cores }}/{{ node.config.cores }}</td>
                        <td>{{ node.workload.ram }}/{{ node.config.ram }}</td>
                        <td>{{ node.workload.memory }}/{{ node.config.memory }}</td>
                        <td>{{ node.workload.tasks }}</td>
                        <td>{{ node.workload.jobs }}</td>
                        <td>{{ node.workload.for_tasks }}</td>
                        <td>{{ node.workload.for_jobs }}</td>
                    </tr>
                {% else %}
                    <tr>
                        <td>{{ node.hostname }}</td>
                        <td>{{ node.get_status_display }}</td>
                        <td>-</td>
                        <td>-</td>
                        <td>-</td>
                        <td>-</td>
                        <td>-</td>
                        <td>-</td>
                        <td>-</td>
                        <td>-</td>
                    </tr>
                {% endif %}
            {% endfor %}
        </tbody>
    </table>
    {% else %}
        <div class="ui grid">
            <div class="sixteen wide column center aligned">
                <h2 class="ui orange header">{% trans "Scheduler doesn't have nodes" %}</h2>
            </div>
        </div>
    {% endif %}
{% endblock %}