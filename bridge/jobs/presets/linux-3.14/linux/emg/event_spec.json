{
  "kernel model": {
    "usb_reset_device": {
      "labels": {},
      "process": "[@usb_reset]",
      "actions": {
        "usb_reset": {
          "parameters": []
        }
      }
    },
    "usb_register_driver": {
      "labels": {
        "usb_driver": {
          "container": true,
          "parameter": true,
          "interface": ["usb.usb_driver"]
        }
      },
      "process": "<assign>.[register] | <none>",
      "actions": {
        "register": {
          "parameters": [
            "%usb_driver%"
          ]
        },
        "assign": {
          "condition": ["$res == 0"],
          "statements": [
            "%usb_driver% = $arg1;"
          ]
        },
        "none": {
          "condition": ["$res != 0"]
        }
      }
    },
    "usb_deregister": {
      "labels": {
        "usb_driver": {
          "container": true,
          "parameter": true,
          "interface": ["usb.usb_driver"]
        }
      },
      "process": "<assign>.[deregister]",
      "actions": {
        "deregister": {
          "parameters": [
            "%usb_driver%"
          ]
        },
        "assign": {
          "statements": [
            "%usb_driver% = $arg1;"
          ]
        }
      }
    },
    "alloc_etherdev_mqs": {
      "labels": {
        "netdev": {
          "container": true,
          "pointer": true,
          "interface": ["net.net_device"]
        }
      },
      "process": "<alloc>.<success> | <fail>",
      "actions": {
        "alloc": {
          "statements": [
            "%netdev% = $ALLOC(%netdev%);"
          ]
        },
        "success": {
          "statements": [
            "return %netdev%;"
          ]
        },
        "fail":{
           "statements": [
            "return 0;"
          ]
        }
      }
    },
    "free_netdev": {
      "labels": {
        "netdev": {
          "container": true,
          "parameter": true,
          "interface": ["net.net_device"]
        }
      },
      "process": "<free>",
      "actions": {
        "free": {
          "statements": [
            "%netdev% = $arg1;",
            "$FREE(%netdev%);"
          ]
        }
      }
    },
    "register_netdev": {
      "labels": {
        "netdev": {
          "container": true,
          "parameter": true,
          "interface": ["net.net_device"]
        }
      },
      "process": "<assign>.[open].[register] | <none>",
      "actions": {
        "open": {
          "callback": "%netdev.net_device_ops.open%",
          "parameters": [
            "%netdev%"
          ]
        },
        "register": {
          "parameters": [
            "%netdev%"
          ]
        },
        "none": {
          "condition": ["$res != 0"]
        },
        "assign": {
          "condition": ["$res == 0"],
          "statements": [
            "%netdev% = $arg1;"
          ]
        }
      }
    },
    "unregister_netdev": {
      "labels": {
        "netdev": {
          "container": true,
          "parameter": true,
          "interface": ["net.net_device"]
        }
      },
      "process": "<assign>.[stop].[deregister]",
      "actions": {
        "stop": {
          "callback": "%netdev.net_device_ops.stop%",
          "parameters": [
            "%netdev%"
          ]
        },
        "deregister": {
          "parameters": [
            "%netdev%"
          ]
        },
        "assign": {
          "statements": [
            "%netdev% = $arg1;"
          ]
        }
      }
    },
    "__platform_driver_register": {
      "labels": {
        "platform_driver": {
          "container": true,
          "parameter": true,
          "interface": ["platform.platform_driver"]
        }
      },
      "process": "<assign>.[register] | <none>",
      "actions": {
        "register": {
          "parameters": [
            "%platform_driver%"
          ]
        },
        "none": {
          "condition": ["$res != 0"]
        },
        "assign": {
          "condition": ["$res == 0"],
          "statements": [
            "%platform_driver% = $arg1;"
          ]
        }
      }
    },
    "platform_driver_probe": {
      "labels": {
        "platform_driver": {
          "container": true,
          "parameter": true,
          "interface": ["platform.platform_driver"]
        },
        "probe": {
          "callback": true,
          "parameter": true,
          "interface": ["platform.probe"]
        }
      },
      "process": "<assign>.[register] | <none>",
      "actions": {
        "register": {
          "parameters": [
            "%platform_driver%"
          ]
        },
        "none": {
          "condition": ["$res != 0"]
        },
        "assign": {
          "condition": ["$res == 0"],
          "statements": [
            "%platform_driver% = $arg1;",
            "%probe% = $arg2;",
            "%platform_driver.probe%=%probe%;"
          ]
        }
      }
    },
    "platform_driver_unregister": {
      "labels": {
        "platform_driver": {
          "container": true,
          "parameter": true,
          "interface": ["platform.platform_driver"]
        }
      },
      "process": "<assign>.[deregister]",
      "actions": {
        "deregister": {
          "parameters": [
            "%platform_driver%"
          ]
        },
        "assign": {
          "statements": [
            "%platform_driver% = $arg1;"
          ]
        }
      }
    },
    "transport_subsystem_register": {
      "labels": {
        "se_subsystem_api": {
          "container": true,
          "parameter": true,
          "interface": ["se_subsystem.se_subsystem_api"]
        }
      },
      "process": "<assign>.[register] | <none>",
      "actions": {
        "register": {
          "parameters": [
            "%se_subsystem_api%"
          ]
        },
        "none": {
          "condition": ["$res != 0"]
        },
        "assign": {
          "condition": ["$res == 0"],
          "statements": [
            "%se_subsystem_api% = $arg1;"
          ]
        }
      }
    },
    "transport_subsystem_release": {
      "labels": {
        "se_subsystem_api": {
          "container": true,
          "parameter": true,
          "interface": ["se_subsystem.se_subsystem_api"]
        }
      },
      "process": "<assign>.[deregister]",
      "actions": {
        "deregister": {
          "parameters": [
            "%se_subsystem_api%"
          ]
        },
        "assign": {
          "statements": [
            "%se_subsystem_api% = $arg1;"
          ]
        }
      }
    },
    "mod_timer,mod_timer_pinned,mod_timer_pending": {
      "labels": {
        "timer_list": {
          "container": true,
          "parameter": true,
          "interface": ["timer.platform_driver"]
        }
      },
      "process": "<assign>.[instance_register] | <none>",
      "actions": {
        "instance_register": {
          "parameters": [
            "%timer_list%"
          ]
        },
        "none": {
          "condition": ["$res != 0"]
        },
        "assign": {
          "condition": ["$res == 0"],
          "statements": [
            "%timer_list% = $arg1;"
          ]
        }
      }
    },
    "setup_timer, setup_timer_on_stack": {
      "labels": {
        "timer_list": {
          "container": true,
          "parameter": true,
          "interface": ["timer.timer_list"]
        },
        "data": {
          "resource": true,
          "parameter": true,
          "interface": ["timer.data"]
        },
        "function": {
          "callback": true,
          "parameter": true,
          "interface": ["timer.callback"]
        }
      },
      "process": "<assign>.[instance_register] | <none>",
      "actions": {
        "instance_register": {
          "parameters": [
            "%timer_list%"
          ]
        },
        "none": {
          "condition": ["$res != 0"]
        },
        "assign": {
          "condition": ["$res == 0"],
          "statements": [
            "%timer_list% = $arg1;",
            "%function% = $arg2",
            "%data% = $arg3",
            "%timer_list.data%=%data%;",
            "%timer_list.function%=%function%;"
          ]
        }
      }
    },
    "del_timer, try_to_del_timer_sync, del_timer_sync": {
      "labels": {
        "timer_list": {
          "container": true,
          "parameter": true,
          "interface": ["timer.timer_list"]
        }
      },
      "process": "<assign>.[instance_deregister]",
      "actions": {
        "instance_deregister": {
          "parameters": [
            "%timer_list%"
          ]
        },
        "assign": {
          "statements": [
            "%timer_list% = $arg1;"
          ]
        }
      }
    },
    "request_threaded_irq": {
      "labels": {
        "thread": {
          "callback": true,
          "interface": ["interrupt.thread"],
          "parameter": true
        },
        "callback": {
          "callback": true,
          "interface": ["interrupt.handler"],
          "parameter": true
        },
        "line": {
          "resource": true,
          "interface": ["interrupt.line"],
          "parameter": true
        },
        "data": {
          "resource": true,
          "interface": ["interrupt.data"],
          "parameter": true
        }
      },
      "process": "<assign>.[irq_register] | <none>",
      "actions": {
        "irq_register": {
          "parameters": [
            "%line%",
            "%callback%",
            "%thread%",
            "%data%"
          ]
        },
        "none": {
          "condition": ["$res != 0"]
        },
        "assign": {
          "condition": ["$res == 0"],
          "statements": [
            "%line% = $arg1;",
            "%callback% = $arg2;",
            "%thread% = $arg3;",
            "%data% = $arg6;"
          ]
        }
      }
    },
    "request_irq": {
      "labels": {
        "thread": {
          "callback": true,
          "interface": ["interrupt.thread"]
        },
        "callback": {
          "callback": true,
          "interface": ["interrupt.handler"],
          "parameter": true
        },
        "line": {
          "resource": true,
          "interface": ["interrupt.line"],
          "parameter": true
        },
        "data": {
          "resource": true,
          "interface": ["interrupt.data"],
          "parameter": true
        }
      },
      "process": "<assign>.[irq_register] | <none>",
      "actions": {
        "irq_register": {
          "parameters": [
            "%line%",
            "%callback%",
            "%thread%",
            "%data%"
          ]
        },
        "none": {
          "condition": ["$res != 0"]
        },
        "assign": {
          "condition": ["$res == 0"],
          "statements": [
            "%line% = $arg1;",
            "%callback% = $arg2;",
            "%thread% = 0;",
            "%data% = $arg5;"
          ]
        }
      }
    },
    "free_irq": {
      "labels": {
        "line": {
          "resource": true,
          "interface": ["interrupt.line"],
          "parameter": true
        }
      },
      "process": "<assign>.[irq_deregister]",
      "actions": {
        "irq_deregister": {
          "parameters": [
            "%line%"
          ]
        },
        "assign": {
          "statements": [
            "%line% = $arg1;"
          ]
        }
      }
    }
  },
  "environment processes": {
    "dummy_factory": {
      "labels": {
        "container": {
          "container": true
        }
      },
      "process": "(!register).[@instance_register].[@instance_deregister].(deregister)",
      "actions": {
        "register": {
          "parameters": [
            "%container%"
          ]
        },
        "deregister": {
          "condition": ["%container% == $ARG1"],
          "parameters": [
            "%container%"
          ]
        },
        "instance_register": {
          "parameters": [
            "%container%"
          ]
        },
        "instance_deregister": {
          "parameters": [
            "%container%"
          ]
        }
      }
    },
    "usb_instance": {
      "labels": {
        "container": {
          "container": true,
          "interface": ["usb.usb_driver"]
        },
        "resource": {
          "resource": true
        },
        "reset_flag": {
          "signature": "bool a",
          "value": "false"
        },
        "probe_retval": {
          "signature": "int a"
        },
        "callback": {
          "callback": true
        }
      },
      "process": "(!instance_register).<alloc>.[probe].(<probe_success>.((usb_reset).[pre].[post] | [suspend].[resume] | [callback] | <null>).[release] | <failed_probe>).<free>.(instance_deregister)",
      "actions": {
        "instance_register": {
          "parameters": [
            "%container%"
          ]
        },
        "instance_deregister": {
          "condition": ["%container% == $ARG1"],
          "parameters": [
            "%container%"
          ]
        },
        "alloc": {
          "statements": [
            "%resource% = $ALLOC(%resource%);"
          ]
        },
        "free": {
          "statements": [
            "$FREE(%resource%);"
          ]
        },
        "callback": {
          "callback": "%callback%",
          "parameters": [
            "%resource%"
          ]
        },
        "probe": {
          "callback": "%container.probe%",
          "parameters": [
            "%resource%"
          ],
          "callback return value": "%probe_retval%",
          "post-call": [
            "%probe_retval% = ldv_post_probe(%probe_retval%);"
          ]
        },
        "release": {
          "callback": "%container.release%",
          "parameters": [
            "%resource%"
          ]
        },
        "suspend": {
          "callback": "%container.suspend%",
          "parameters": [
            "%resource%"
          ]
        },
        "resume": {
          "callback": "%container.resume%",
          "parameters": [
            "%resource%"
          ]
        },
        "pre": {
          "callback": "%container.pre%",
          "parameters": ["%resource%"]
        },
        "post": {
          "callback": "%container.post%",
          "parameters": ["%resource%"]
        },
        "usb_reset": {},
        "probe_success": {
          "condition": ["%probe_retval% == 0"]
        },
        "failed_probe": {
          "condition": ["%probe_retval% != 0"]
        },
        "null": {}
      }
    },
    "platform_instance": {
      "labels": {
        "container": {
          "container": true
        },
        "resource": {
          "resource": true
        },
        "callback": {
          "callback": true
        },
        "probed": {
          "signature": "int a",
          "value": "1"
        },
        "suspended": {
          "signature": "int a"
        }
      },
      "process": "(!register).<init>.{call}",
      "actions": {
        "call": {
          "process": "[callback].{call} | <positive_probe>.[release].<after_release>.{call} |  <positive_probe>.[suspend].(<suspended>.[resume] | <not_suspended>).{call} | <negative_probe>.(<free>.(deregister) | [probe].{call})"
        },
        "register": {
          "parameters": [
            "%container%"
          ]
        },
        "deregister": {
          "parameters": [
            "%container%"
          ]
        },
        "callback": {
          "callback": "%callback%",
          "parameters": [
            "%resource%"
          ]
        },
        "release": {
          "callback": "%container.release%",
          "parameters": [
            "%resource%"
          ]
        },
        "probe": {
          "callback": "%container.probe%",
          "parameters": [
            "%resource%"
          ],
          "callback return value": "%probed%",
          "post-call": [
            "%probed% = ldv_post_probe(%probed%);"
          ]
        },
        "suspend": {
          "callback": "%container.suspend%",
          "parameters": [
            "%resource%"
          ],
          "callback return value": "%suspended%"
        },
        "resume": {
          "callback": "%container.resume%",
          "parameters": [
            "%resource%"
          ]
        },
        "init": {
          "statements": [
            "%resource% = $ALLOC(%resource%);"
          ]
        },
        "free": {
          "statements": [
            "$FREE(%resource%);"
          ]
        },
        "after_release": {
          "statements": [
            "%probed% = 1;"
          ]
        },
        "positive_probe": {
          "condition": ["%probed% == 0"]
        },
        "negative_probe": {
          "condition": ["%probed% != 0"]
        },
        "suspended": {
          "condition": ["%suspended% == 0"]
        },
        "not_suspended": {
          "condition": ["%suspended% != 0"]
        }
      }
    },
    "transport_instance": {
      "labels": {
        "se_subsystem_api": {
          "container": true,
          "interface": ["se_subsystem.se_subsystem_api"]
        },
        "se_hba": {
          "interface": ["se_subsystem.se_hba"]
        },
        "se_device": {
          "interface": ["se_subsystem.se_device"]
        },
        "attach_hba": {
          "callback": true,
          "interface": ["se_subsystem.attach_hba"]
        },
        "detach_hba": {
          "callback": true,
          "interface": ["se_subsystem.detach_hba"]
        },
        "callback": {
          "callback": true
        },
        "probed": {
          "signature": "int a",
          "value": "1"
        }
      },
      "process": "(!register).<init>.[probe].<post_probe>.{call}",
      "actions": {
        "call": {
          "process": "<positive_probe>.[callback].{call} | [attach_hba].[detach_hba].{call} | <positive_probe>.[release].<after_release>.{call} | <negative_probe>.(<free>.(deregister) | [probe].<post_probe>.{call})"
        },
        "register": {
          "parameters": [
            "%se_subsystem_api%"
          ]
        },
        "deregister": {
          "parameters": [
            "%se_subsystem_api%"
          ]
        },
        "callback": {
          "callback": "%callback%",
          "parameters": ["%se_hba%", "%se_device%"]
        },
        "release": {
          "callback": "%se_subsystem_api.release%",
          "parameters": [
            "%se_device%"
          ]
        },
        "probe": {
          "callback": "%se_subsystem_api.probe%",
          "parameters": [
            "%se_hba%"
          ],
          "callback return value": "%se_device%"
        },
        "attach_hba": {
          "callback": "%attach_hba%",
          "parameters": [
            "%se_hba%"
          ]
        },
        "detach_hba": {
          "callback": "%detach_hba%",
          "parameters": [
            "%se_hba%"
          ]
        },
        "init": {
          "statements": [
            "%se_hba% = $ALLOC(%se_hba%);"
          ]
        },
        "free": {
          "statements": [
            "$FREE(%se_hba%);"
          ]
        },
        "after_release": {
          "statements": [
            "%probed% = 1;"
          ]
        },
        "post_probe": {
          "statements": [
            "if (%se_device%)",
            " %probed% = 0;"
          ]
        },
        "positive_probe": {
          "condition": ["%probed% == 0"]
        },
        "negative_probe": {
          "condition": ["%probed% != 0"]
        }
      }
    },
    "io_instance": {
      "labels": {
        "container": {
          "container": true
        },
        "resource": {
          "resource": true
        },
        "callback": {
          "callback": true
        },
        "probed": {
          "signature": "int a",
          "value": "1"
        }
      },
      "process": "(!register).<init>.{call}",
      "actions": {
        "call": {
          "process": "[callback].{call} | <positive_probe>.[release].<after_release>.{call} | <negative_probe>.(<free>.(deregister) | [probe].{call})"
        },
        "register": {
          "parameters": [
            "%container%"
          ]
        },
        "deregister": {
          "parameters": [
            "%container%"
          ]
        },
        "callback": {
          "callback": "%callback%",
          "parameters": [
            "%resource%"
          ]
        },
        "release": {
          "callback": "%container.release%",
          "parameters": [
            "%resource%"
          ]
        },
        "probe": {
          "callback": "%container.probe%",
          "parameters": [
            "%resource%"
          ],
          "callback return value": "%probed%",
          "post-call": [
            "%probed% = ldv_post_probe(%probed%);"
          ]
        },
        "init": {
          "statements": [
            "%resource% = $ALLOC(%resource%);"
          ]
        },
        "free": {
          "statements": [
            "$FREE(%resource%);"
          ]
        },
        "after_release": {
          "statements": [
            "%probed% = 1;"
          ]
        },
        "positive_probe": {
          "condition": ["%probed% == 0"]
        },
        "negative_probe": {
          "condition": ["%probed% != 0"]
        }
      }
    },
    "dummy_resourceless_instance": {
      "labels": {
        "container": {
          "container": true,
          "resource": true
        },
        "callback": {
          "callback": true
        }
      },
      "process": "(!register).{call}",
      "actions": {
        "call": {
          "process": "[callback].{call} | (deregister)"
        },
        "register": {
          "parameters": [
            "%container%"
          ]
        },
        "deregister": {
          "condition": ["%container% == $ARG1"],
          "parameters": [
            "%container%"
          ]
        },
        "callback": {
          "callback": "%callback%",
          "parameters": [
            "%container%"
          ]
        }
      }
    },
    "dummy_instance": {
      "labels": {
        "container": {
          "container": true
        },
        "resource": {
          "resource": true
        },
        "callback": {
          "callback": true
        }
      },
      "process": "(!register).<init>.{call}",
      "actions": {
        "call": {
          "process": "[callback].{call} | <free>.(deregister)"
        },
        "register": {
          "parameters": [
            "%container%"
          ]
        },
        "deregister": {
          "condition": ["%container% == $ARG1"],
          "parameters": [
            "%container%"
          ]
        },
        "callback": {
          "callback": "%callback%",
          "parameters": [
            "%resource%"
          ]
        },
        "init": {
          "statements": [
            "%resource% = $ALLOC(%resource%);"
          ]
        },
        "free": {
          "statements": [
            "$FREE(%resource%);"
          ]
        }
      }
    },
    "timer_instance": {
      "labels": {
        "container": {
          "container": true,
          "interface": ["timer.timer_list"]
        }
      },
      "process": "(!instance_register).[callback].(instance_deregister)",
      "actions": {
        "instance_register": {
          "parameters": [
            "%container%"
          ]
        },
        "instance_deregister": {
          "condition": ["%container% == $ARG1"],
          "parameters": [
            "%container%"
          ]
        },
        "callback": {
          "callback": "%container.handler%",
          "parameters": [
            "%container.data%"
          ]
        }
      }
    },
    "interrupt_instance": {
      "labels": {
        "thread": {
          "callback": true,
          "interface": ["interrupt.thread"]
        },
        "callback": {
          "callback": true,
          "interface": ["interrupt.handler"]
        },
        "line": {
          "resource": true,
          "interface": ["interrupt.line"]
        },
        "data": {
          "resource": true,
          "interface": ["interrupt.data"]
        },
        "ret_val": {
          "signature": "irqreturn_t a"
        }
      },
      "process": "(!irq_register).[handler].(<need_thread>.[thread] | <handled>).(irq_deregister)",
      "actions": {
        "irq_register": {
           "parameters": [
             "%line%",
             "%callback%",
             "%thread%",
             "%data%"
           ]
        },
        "irq_deregister": {
          "condition": ["%line% == $ARG1"],
          "parameters": [
            "%line%"
          ]
        },
        "handler": {
          "callback": "%callback%",
          "parameters": [
            "%line%",
            "%data%"
          ],
          "callback return value": "%ret_val%"
        },
        "thread": {
          "callback": "%thread%",
          "parameters": [
            "%line%",
            "%data%"
          ]
        },
        "need_thread": {
          "condition": ["%ret_val% == IRQ_WAKE_THREAD"]
        },
        "handled": {
          "condition": ["%ret_val% != IRQ_WAKE_THREAD"]
        }
      }
    }
  }
}
