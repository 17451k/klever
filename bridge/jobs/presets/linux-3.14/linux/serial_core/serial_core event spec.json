{
  "Linux 3.14 (base)": {
    "kernel model": {
      "uart_add_one_port": {
        "labels": {
          "uart_port": {
            "container": true,
            "parameter": true,
            "interface": [
              "uart.uart_port"
            ]
          }
        },
        "process": "<alloc>.[register].<success> | <fail>",
        "actions": {
          "alloc": {
            "statements": [
              "%uart_port% = $arg2;"
            ]
          },
          "register": {
            "parameters": [
              "%uart_port%"
            ]
          },
          "success": {
	    "statements": [
	      "return 0;"
	    ]
	  },
	  "fail": {
	    "statements": [
	      "return -1;"
	    ]
	  }
        }
      },
      "uart_remove_one_port": {
        "labels": {
          "uart_port": {
            "container": true,
            "parameter": true,
            "interface": [
              "uart.uart_port"
            ]
          }
        },
        "process": "<assign>.[deregister].<success> | <fail>",
        "actions": {
          "assign": {
            "statements": [
              "%uart_port% = $arg2;"
            ]
          },
          "deregister": {
            "parameters": [
              "%uart_port%"
            ]
          },
          "success": {
	    "statements": [
	      "return 0;"
	    ]
	  },
	  "fail": {
	    "statements": [
	      "return -1;"
	    ]
	  }
        }
      }
    },
    "environment processes": {
      "uart_instance": {
        "labels": {
          "uart_port": {
	    "container": true,
	    "pointer": true,
            "interface": [
              "uart.uart_port"
            ]
          },
          "callback": {
            "callback": true
          },
          "ret": {
            "signature": "int a",
            "value": "1"
          },
          "uret": {
	    "signature": "unsigned int b",
	    "value": "1"
	  },
	  "state": {
	    "interface": [
	      "uart.state"
	    ]
	  },
	  "oldstate": {
	    "interface": [
	      "uart.oldstate"
	    ]
	  }
        },
        "process": "(!register).<init_state>.{main}",
        "actions": {
          "main": {
            "process": "<set_state_on>.[pm_on].[startup].(<y_ret>.[set_termios].[get_mctrl].(<y_uret>.[stop_tx] | <n_uret>.[start_tx]).[set_mctrl].{call} | <n_ret>.[stop_rx].[shutdown].<set_state_off>.[pm_off]).{main} | (deregister)"
          },
          "call": {
            "process": "([callback] | [set_termios] | [throttle].[set_mctrl].[send_xchar].[start_tx_if].[unthrottle].[send_xchar].[start_tx_if] | [start_tx].[stop_tx]).{call} | [stop_rx].[set_mctrl].[shutdown].<set_state_off>.[pm_off].{main}"
          },
          "register": {
            "parameters": [
              "%uart_port%"
            ]
          },
          "deregister": {
            "condition": [
              "%uart_port% == $ARG1"
            ],
            "parameters": [
              "%uart_port%"
            ]
          },
          "init_state": {
	    "statements": [
	      "%oldstate% = 4U;"
	    ]
	  },
	  "set_state_on": {
	    "statements": [
	      "%state% = 0U;"
	    ]
	  },
	  "set_state_off": {
	    "statements": [
	      "%state% = 3U;"
	    ]
	  },
          "pm_on": {
            "callback": "%uart_port.uart_ops.pm%",
            "parameters": [
              "%uart_port%",
              "%state%",
              "%oldstate%"
            ],
            "post_call": [
	      "%oldstate% = 0U;"
	    ]
          },
          "pm_off": {
            "callback": "%uart_port.uart_ops.pm%",
            "parameters": [
              "%uart_port%",
              "%state%",
              "%oldstate%"
            ],
            "post_call": [
	      "%old% = 3U;"
	    ]
          },
          "startup": {
            "callback": "%uart_port.uart_ops.startup%",
            "parameters": [
              "%uart_port%"
            ],
            "callback return value": "%ret%",
            "post-call": [
              "%ret% = ldv_filter_err_code(%ret%);"
            ]
          },
          "set_termios": {
            "callback": "%uart_port.uart_ops.set_termios%",
            "parameters": [
              "%uart_port%"
            ]
          },
          "get_mctrl": {
            "callback": "%uart_port.uart_ops.get_mctrl%",
            "parameters": [
              "%uart_port%"
            ],
            "callback return value": "%uret%",
            "post-call": [
              "%uret% = ldv_filter_err_code(%uret%);"
            ]
          },
          "set_mctrl": {
            "callback": "%uart_port.uart_ops.set_mctrl%",
            "parameters": [
              "%uart_port%"
            ]
          },
          "stop_rx": {
	    "callback": "%uart_port.uart_ops.stop_rx%",
	    "parameters": [
	      "%uart_port%"
	    ]
	  },
          "stop_tx": {
            "callback": "%uart_port.uart_ops.stop_tx%",
            "parameters": [
              "%uart_port%"
            ]
          },
          "start_tx": {
            "callback": "%uart_port.uart_ops.start_tx%",
            "parameters": [
              "%uart_port%"
            ]
          },
          "start_tx_if": {
            "callback": "%uart_port.uart_ops.start_tx%",
            "parameters": [
              "%uart_port%"
            ],
            "contition": [
              "!%uart_port.uart_ops.send_xchar%"
            ]
          },
          "throttle": {
            "callback": "%uart_port.uart_ops.throttle%",
            "parameters": [
              "%uart_port%"
            ]
          },
          "unthrottle": {
            "callback": "%uart_port.uart_ops.unthrottle%",
            "parameters": [
              "%uart_port%"
            ]
          },
          "send_xchar": {
            "callback": "%uart_port.uart_ops.send_xchar%",
            "parameters": [
              "%uart_port%"
            ],
            "contition": [
              "%uart_port.uart_ops.send_xchar%"
            ]
          },
          "shutdown": {
            "callback": "%uart_port.uart_ops.shutdown%",
            "parameters": [
              "%uart_port%"
            ]
          },
          "callback": {
	    "callback": "%callback%",
	    "parameters": [
	      "%uart_port%"
	    ]
	  },
          "y_ret": {
            "condition": [
              "%ret% == 0"
            ]
          },
          "n_ret": {
            "condition": [
              "%ret% != 0"
            ]
          },
          "y_uret": {
            "condition": [
              "%uret% == 0"
            ]
          },
          "n_uret": {
            "condition": [
              "%uret% != 0"
            ]
          }
        }
      }
    }
  }
}